import{R as m,u as x,a as u,j as a,s as y,r as h,b as v,c as C,d as P,V as g,e as E,f as b,g as $}from"./index-lGg_5XmJ.js";var _={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},S=m.createContext&&m.createContext(_),A=["attr","size","title"];function L(e,t){if(e==null)return{};var s=z(e,t),n,i;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(i=0;i<d.length;i++)n=d[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function z(e,t){if(e==null)return{};var s={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;s[n]=e[n]}return s}function j(){return j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},j.apply(this,arguments)}function O(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),s.push.apply(s,n)}return s}function w(e){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?O(Object(s),!0).forEach(function(n){k(e,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):O(Object(s)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(s,n))})}return e}function k(e,t,s){return t=B(t),t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function B(e){var t=D(e,"string");return typeof t=="symbol"?t:t+""}function D(e,t){if(typeof e!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var n=s.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function M(e){return e&&e.map((t,s)=>m.createElement(t.tag,w({key:s},t.attr),M(t.child)))}function N(e){return t=>m.createElement(I,j({attr:w({},e.attr)},t),M(e.child))}function I(e){var t=s=>{var{attr:n,size:i,title:d}=e,l=L(e,A),o=i||s.size||"1em",c;return s.className&&(c=s.className),e.className&&(c=(c?c+" ":"")+e.className),m.createElement("svg",j({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,n,l,{className:c,style:w(w({color:e.color||s.color},s.style),e.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),d&&m.createElement("title",null,d),e.children)};return S!==void 0?m.createElement(S.Consumer,null,s=>t(s)):t(_)}function R(e){return N({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M19.023 16.977a35.13 35.13 0 0 1-1.367-1.384c-.372-.378-.596-.653-.596-.653l-2.8-1.337A6.962 6.962 0 0 0 16 9c0-3.859-3.14-7-7-7S2 5.141 2 9s3.14 7 7 7c1.763 0 3.37-.66 4.603-1.739l1.337 2.8s.275.224.653.596c.387.363.896.854 1.384 1.367l1.358 1.392.604.646 2.121-2.121-.646-.604c-.379-.372-.885-.866-1.391-1.36zM9 14c-2.757 0-5-2.243-5-5s2.243-5 5-5 5 2.243 5 5-2.243 5-5 5z"},child:[]}]})(e)}const T=({user:e})=>{const t=x(),{selectedUser:s}=u(d=>d.users),{onlineUsers:n}=u(d=>d.users),i=()=>{t(y(e))};return a.jsxs("div",{children:[a.jsxs("div",{onClick:i,className:`${(s==null?void 0:s._id)===(e==null?void 0:e._id)?"bg-zinc-200 text-black":"text-white"}  flex gap-2 items-center  hover:bg-zinc-200 hover:text-black p-2 rounded-sm cursor-pointer`,children:[a.jsx("div",{className:`avatar ${n.includes(e==null?void 0:e._id)?"avatar-online":"avatar-ofline"}`,children:a.jsx("div",{className:"w-16 rounded-full",children:a.jsx("img",{src:e==null?void 0:e.profilePic,alt:"user-profile"})})}),a.jsx("div",{className:"  font-bold text-xl",children:e==null?void 0:e.userName})]}),a.jsx("div",{className:"divider my-0 py-0 font-black h-1"})]})},U=({searchUser:e})=>(e==null?void 0:e.length)==0?a.jsx("div",{className:"font-bold w-full my-28 text-center ",children:"No User Found Of This Name"}):a.jsx("div",{className:"  text-white flex-1 ",children:e==null?void 0:e.map(t=>a.jsx(T,{user:t},t._id))}),G="https://Samvada-Chatting-App.onrender.com",W=()=>{const e=x();h.useEffect(()=>{(async()=>{var s;try{const n=await v.get(`${G}/api/v1/user/otherUsers`,{withCredentials:!0});e(C((s=n==null?void 0:n.data)==null?void 0:s.users))}catch(n){console.log(n==null?void 0:n.message)}})()},[])},V="https://Samvada-Chatting-App.onrender.com",F=()=>{W();const{otherUsers:e}=u(c=>c.users),[t,s]=h.useState(""),[n,i]=h.useState([]);h.useEffect(()=>{i(e.filter(c=>c.userName.toLowerCase().startsWith(t.toLowerCase())))},[t,e]);const d=P(),l=x(),o=async()=>{var c,f,p;try{const r=await v.get(`${V}/api/v1/user/logout`,{withCredentials:!0});(c=r==null?void 0:r.data)!=null&&c.success?(g.success((f=r==null?void 0:r.data)==null?void 0:f.message),l(E(null)),l(C([])),l(y(null)),l(b([])),l($([])),d("/login")):g.error((p=r==null?void 0:r.data)==null?void 0:p.message)}catch(r){g.error(r.message)}};return a.jsxs("div",{className:`\r
    \r
        flex flex-col\r
        w-screen        /* Fixed width on desktop */\r
        sm:w-72      /* Slightly narrower on small screens */\r
        flex-shrink-0\r
      `,children:[a.jsx("div",{className:"text-green-500 flex justify-center text-2xl font-bold",children:"Samvada"}),a.jsxs("form",{action:"",className:"flex mt-2 items-center gap-2",children:[a.jsx("input",{value:t,onChange:c=>{var f;s((f=c==null?void 0:c.target)==null?void 0:f.value)},type:"text",className:`\r
            input input-bordered\r
            w-full\r
            rounded-md\r
          `,placeholder:"Search..."}),a.jsx("button",{type:"submit",className:`\r
            btn bg-zinc-600 text-white\r
            min-w-10\r
            px-3\r
            py-2\r
            md:px-4\r
          `,children:a.jsx(R,{className:"w-5 h-5 md:w-6 md:h-6"})})]}),a.jsx("div",{className:"divider px-3 my-5"}),a.jsx("div",{className:"",children:a.jsx(U,{searchUser:n})}),a.jsx("div",{className:"mt-2 flex  justify-center",children:a.jsx("button",{className:"btn mb-2 btn-sm w-full md:w-auto hover:bg-blue-600 hover:text-white",onClick:o,children:"Logout"})})]})},H=({m:e})=>{const{user:t}=u(o=>o.users),{selectedUser:s}=u(o=>o.users),n=h.useRef();h.useEffect(()=>{var o;(o=n.current)==null||o.scrollIntoView({behavior:"smooth"})},[e]);const i=new Date(e==null?void 0:e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),l=new Date(e.createdAt).toLocaleDateString([],{day:"numeric",month:"long"});return a.jsx("div",{ref:n,className:"",children:a.jsxs("div",{className:`chat ${(e==null?void 0:e.senderId)===(t==null?void 0:t._id)?"chat-end":"chat-start"}`,children:[a.jsx("div",{className:"chat-image avatar",children:a.jsx("div",{className:"w-10 rounded-full",children:a.jsx("img",{alt:"Tailwind CSS chat bubble component",src:(e==null?void 0:e.senderId)===(t==null?void 0:t._id)?t==null?void 0:t.profilePic:s==null?void 0:s.profilePic})})}),a.jsx("div",{className:"chat-header",children:a.jsx("time",{className:"text-xs opacity-50 text-white hover:bg-black text-xl",children:`${l}  ${i}`})}),a.jsx("div",{className:`chat-bubble ${(e==null?void 0:e.senderId)===(t==null?void 0:t._id)?"bg-green-300":"bg-white"}`,children:e==null?void 0:e.message})]})})},K="https://Samvada-Chatting-App.onrender.com",Z=()=>{const{selectedUser:e}=u(s=>s.users),t=x();h.useEffect(()=>{(async()=>{try{v.defaults.withCredentials=!0;const n=await v.post(`${K}/api/v1/message/getMessages/${e==null?void 0:e._id}`);t(b(n==null?void 0:n.data))}catch(n){console.log(n==null?void 0:n.message)}})()},[e==null?void 0:e._id])},q=()=>{const{socket:e}=u(n=>n.sockets),{messages:t}=u(n=>n.Messages),s=x();h.useEffect(()=>(e==null||e.on("newMessage",n=>{s(b([...t,n]))}),()=>e==null?void 0:e.off("newMessage")),[b,t])},J=()=>{Z(),q();const{messages:e}=u(t=>t.Messages);if(e)return a.jsx("div",{className:"px-4 flex-1  text-white",children:e.map(t=>a.jsx(H,{m:t},t._id))})};function Q(e){return N({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M7.712 4.818A1.5 1.5 0 0 1 10 6.095v2.972c.104-.13.234-.248.389-.343l6.323-3.906A1.5 1.5 0 0 1 19 6.095v7.81a1.5 1.5 0 0 1-2.288 1.276l-6.323-3.905a1.505 1.505 0 0 1-.389-.344v2.973a1.5 1.5 0 0 1-2.288 1.276l-6.323-3.905a1.5 1.5 0 0 1 0-2.552l6.323-3.906Z"},child:[]}]})(e)}function X(e){return N({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"m476.59 227.05-.16-.07L49.35 49.84A23.56 23.56 0 0 0 27.14 52 24.65 24.65 0 0 0 16 72.59v113.29a24 24 0 0 0 19.52 23.57l232.93 43.07a4 4 0 0 1 0 7.86L35.53 303.45A24 24 0 0 0 16 327v113.31A23.57 23.57 0 0 0 26.59 460a23.94 23.94 0 0 0 13.22 4 24.55 24.55 0 0 0 9.52-1.93L476.4 285.94l.19-.09a32 32 0 0 0 0-58.8z"},child:[]}]})(e)}const Y="https://Samvada-Chatting-App.onrender.com",ee=()=>{const[e,t]=h.useState(""),{selectedUser:s}=u(l=>l.users),{messages:n}=u(l=>l.Messages),i=x(),d=async l=>{var o,c,f,p;l.preventDefault();try{const r=await v.post(`${Y}/api/v1/message/sendMessage/${s._id}`,{message:e},{headers:{"Content-Type":"application/json"},withCredentials:!0});(o=r==null?void 0:r.data)!=null&&o.status?(g.success((c=r==null?void 0:r.data)==null?void 0:c.message),i(b([...n,(f=r==null?void 0:r.data)==null?void 0:f.newMessage])),t("")):g.error((p=r==null?void 0:r.data)==null?void 0:p.message)}catch(r){g.error(r==null?void 0:r.message)}};return a.jsx("form",{className:"px-4 my-3   ",onSubmit:d,children:a.jsxs("div",{className:"w-full relative",children:[a.jsx("input",{type:"text",value:e,onChange:l=>{var o;return t((o=l==null?void 0:l.target)==null?void 0:o.value)},placeholder:"Send a Message...",className:"border p-3 border-zinc-500 text-sm mb-1 rounded-lg block w-full bg-gray-600 text-white"}),a.jsx("button",{className:"absolute inset-y-0 end-0 pr-4 flex items-center",children:a.jsx(X,{})})]})})},te=()=>{const e=x(),t=P(),{selectedUser:s}=u(i=>i.users),{onlineUsers:n}=u(i=>i.users);return a.jsxs("div",{className:"flex flex-col flex-1 w-full h-full",children:[a.jsxs("div",{className:"flex gap-2 items-center p-2 rounded-sm cursor-pointer bg-white mb-2",children:[a.jsx("button",{className:"px-1 cursor-pointer",onClick:()=>{e(y(null)),t("/")},children:a.jsx(Q,{})}),a.jsx("div",{className:`avatar ${n.includes(s._id)?"avatar-online":"avatar-offline"}`,children:a.jsx("div",{className:"w-16 rounded-full",children:a.jsx("img",{src:s==null?void 0:s.profilePic,alt:"user-profile"})})}),a.jsx("div",{className:"text-xl",children:s==null?void 0:s.userName})]}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:a.jsx(J,{})}),a.jsx(ee,{})]})},ne=()=>{const{selectedUser:e}=u(t=>t.users);return a.jsx("div",{className:`\r
        bg-[url(/background.jpg)]\r
        bg-cover bg-center\r
        min-h-screen w-screen\r
        px-2 py-4\r
        flex justify-center items-center\r
      `,children:a.jsxs("div",{className:`\r
          w-full\r
          h-[90vh]\r
          flex\r
          flex-col lg:flex-row\r
          overflow-hidden\r
          rounded-lg\r
          max-w-4xl\r
        `,children:[a.jsx("div",{className:`
            ${e?"hidden lg:block":"block"} 
            w-full lg:w-1/3
            h-full
            overflow-y-auto
          `,children:a.jsx(F,{})}),a.jsx("div",{className:`
            ${e?"block":"hidden"} 
            lg:flex
            w-full lg:w-2/3
            h-full
            flex-col
          `,children:e?a.jsx(te,{}):a.jsx("div",{className:"hidden lg:flex flex-1 items-center justify-center text-white text-lg font-semibold text-center px-4",children:a.jsx("p",{children:"✅Let's start a Samvada—pick someone to chat with.”"})})})]})})};export{ne as default};
